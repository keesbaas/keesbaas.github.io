<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>zion '25</title>
    <link rel="stylesheet" href="style2.css"> <!-- Links your styles -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- Leaflet CSS -->
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>


<style>
  /* Map styling */

    .map-text-container {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin: 20px 1%;
    }
    
  #map {
    flex: 0 0 50%;          /* roughly half the page */
    height: 800px;       /* taller map */
    
  }

  /* Right-side text */
  .right-text {
    flex: 0 0 40%;          /* roughly half the page */
    
    font-family: Arial, sans-serif;
    text-align: center;
    
    color: #000000;
  }

  /* Clear floats after container */
  .map-text-container::after {
    content: "";
    display: table;
    clear: both;
  }

.photo-label-text {
  background: none;     /* no background */
  border: none;         /* no border */
  padding: 0;           /* remove padding */
  color: white;         /* text color */
  font-weight: normal;  /* optional */
  font-size: 12px;      /* adjust as needed */
}

    
</style>

</head>
<body>
    <header>
        
        <h1>zion '25</h1>
            <a href="index.html" class="fade-link">back</a>
    
            <style>
            .fade-link,
            .fade-link:visited {
              color: #000000;
              text-decoration: none;
                display: block;
              text-align: center;
              margin-top: 10px;
              transition: color 0.25s ease;
            }
            
            .fade-link:hover {
              color: #333333;
            }
            </style>
    </header>
    
    <!-- Zion hike map -->
<div class="map-text-container">
    <div id="map"></div>
    <div class="right-text">
        <p>this is a map!</p>
        <p>of zion!</p>
    </div>
</div>

<!-- Container where JS will populate rows -->
<div class="album-container" id="album-container"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Leaflet GPX plugin -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/1.7.0/gpx.min.js"></script>



<script>
  const map = L.map('map').setView([37.2982, -113.0263], 10);

  L.tileLayer(
    'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
    { attribution: 'Esri' }
  ).addTo(map);

// Load Zion park boundary
fetch('visited_parks.geojson')
  .then(response => response.json())
  .then(data => {
    L.geoJSON(data, {
      style: {
        color: '#ffffff',    // border color
        weight: 2,
        fillColor: '#ffffff', // semi-transparent fill
        fillOpacity: 0.2
      }
    }).addTo(map);
  })
  .catch(err => console.error('Failed to load boundary geojson:', err));

  new L.GPX('ZionTraverse.gpx', {
    async: true,
    polyline_options: {
      color: '#00E5FF',
      weight: 4,
      opacity: 0.9
    },
    
    marker_options: {
      startIconUrl: null,   // no start marker
      endIconUrl: null,     // no end marker
      shadowUrl: null
    
  
    }
  })
  .on('loaded', function(e) {
    map.fitBounds(e.target.getBounds(), { padding: [20, 20] });
  })
  .on('error', function(err){
    console.error('Failed to load GPX:', err);
  })
  .addTo(map);

const blackTriangle = L.divIcon({
    className: '', // no default styles
    html: '<div style="width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 10px solid white;"></div>',
    iconSize: [10, 10],
    iconAnchor: [5, 10] // point the tip at the location
});



    
  // Add photo markers along the route
  const photos = [
    
    { id: 0, lat: 37.451913033497036, lng: -113.19085476210358, caption: "Start View" }, // Lee's Passs 37.451913033497036, -113.19085476210358
    { id: 1, lat: 37.2990, lng: -113.025, caption: "Canyon Overlook" },
    { id: 2, lat: 37.3000, lng: -113.023, caption: "Trail Junction" }
    // ...add more with correct lat/lng and your album index
  ];

  photos.forEach(photo => {
    const marker = L.marker([photo.lat, photo.lng], {
      title: photo.caption,
        icon: blackTriangle
    }).addTo(map);

       marker.bindTooltip(photo.caption, {
    permanent: true,       // always visible
    direction: 'top',      // position above marker
    offset: [10, -10],     // x (right), y (up) in pixels
    className: 'photo-label-text'  // optional CSS class for styling
  });

    marker.on('click', () => {
      // Scroll to the photo in your album
      const photoRow = document.querySelectorAll('.photo-row')[photo.id];
      if(photoRow){
        photoRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    });
  });
</script>

    
<!-- <script>
  // Initialize map centered on Zion
  const map = L.map('map').setView([37.2982, -113.0263], 13);

  // ESRI World Imagery basemap
  L.tileLayer(
    'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
    { attribution: 'Esri' }
  ).addTo(map);

  // Load and animate GPX trail
  new L.GPX('ZionTraverse.gpx', {
    async: true,
    polyline_options: {
      color: '#00E5FF',
      weight: 4,
      opacity: 0.9
    },
    marker_options: {
      startIcon: null,   // remove start marker
      endIcon: null,     // remove end marker
      shadow: null
    }
  })
  .on('loaded', function(e) {
    // Loop through all layers (tracks) in the GPX file
    e.target.getLayers().forEach(polyline => {
      if (polyline instanceof L.Polyline) {
        const latlngs = polyline.getLatLngs();

        // Zoom map to bounds of this track
        map.fitBounds(polyline.getBounds(), { padding: [20, 20] });

        // Animate drawing
        polyline.setLatLngs([]); // start with empty line
        let i = 0;
        const drawInterval = setInterval(() => {
          if (i < latlngs.length) {
            polyline.addLatLng(latlngs[i]);
            i++;
          } else {
            clearInterval(drawInterval);
          }
        }, 25); // adjust speed here (ms per point)
      }
    });
  })
  .on('error', function(err){
    console.error('Failed to load GPX:', err);
  })
  .addTo(map);
</script> -->


    
<script>
  const container = document.getElementById('album-container');

  // Load photo data from JSON
  fetch('photos.json')
    .then(response => response.json())
    .then(photos => {
      photos.forEach(photo => {
        const row = document.createElement('div');
        row.className = 'photo-row';

        // Link to high-res
        const link = document.createElement('a');
        link.href = photo.highres;
        link.target = "_blank";

        // Image
        const img = document.createElement('img');
        img.src = photo.src;
        img.alt = photo.caption;
        img.loading = "eager";  // ensures image loads right away

        link.appendChild(img);

        // Caption
        const p = document.createElement('p');
        p.textContent = photo.caption;

        // Append to row
        row.appendChild(link);
        row.appendChild(p);
        container.appendChild(row);
      });

      // Fade-in on scroll
      const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.2 });

      document.querySelectorAll('.photo-row').forEach(row => observer.observe(row));
    })
    .catch(err => console.error('Failed to load photos.json:', err));
</script>

</body>
</html>
