<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>zion '25</title>
    <link rel="stylesheet" href="style2.css"> <!-- Links your styles -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- Leaflet CSS -->
<link
  rel="stylesheet"
  href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
/>


<style>
  

      
</style>

</head>
<body>
    <header>
        
        <h1>zion '25</h1>
            <a href="index.html" class="fade-link">back</a>
    
            <style>
            .fade-link,
            .fade-link:visited {
              color: F0EAD6;
              text-decoration: none;
                display: block;
              text-align: center;
              margin-top: 10px;
              transition: color 0.25s ease;
            }
            
            .fade-link:hover {
              color: #333333;
            }
            </style>
    </header>
    
    <!-- Zion hike map -->
<div class="map-text-container">
    <div id="map"></div>
    <div class="right-text">
       
        <p>    For climbsgiving 2025, Matt and I decided to backpack the Zion traverse which is the route shown on the map. It cuts across the park from the west to the east over ~50 miles. We both flew in to Vegas, grabbed some breakfast at Mister Mommas, and drove out to Zion. We grabbed dinner at whatever pub is right next to visitor center and got our permits early the next morning. The traverse is cut-off at the last ~10 miles because of a rockfall in 2019, so we asked the ranger if we could get permits for both the west and east side separately, doing the east rim portion as an out and back. He said we wouldn't want to after finishing the west rim. Which we didn't like, but it's all good. </p>
        <br>
        <p>    We got breakfast at The Park House Cafe, could not reccommend enough. Quirky spot with like, three tables. Mostly packed this day since our permit started the next day. Then got dinner at the Pizza and Noodle Shop which was in an old Mormon church. We learned about liquor laws from our server who tried really hard to give us Thanksgiving meal reccommendations. Next day we caught a shuttle from Tam and took off on the trek!</p>
        
    </div>
</div>

<!-- Container where JS will populate rows -->
<div class="album-container" id="album-container"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<!-- Leaflet GPX plugin -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-gpx/1.7.0/gpx.min.js"></script>



<script>
  const map = L.map('map').setView([37.2982, -113.0263], 10);

  // L.tileLayer(
  //   'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
  //   { attribution: 'Esri' }
  // ).addTo(map);

    // --- Esri basemaps ---

const esriImagery = L.tileLayer(
  'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
  { attribution: 'Esri' }
);

const esriTopo = L.tileLayer(
  'https://server.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}',
  { attribution: 'Esri' }
);

// Labels (shared overlay)
const esriLabels = L.tileLayer(
  'https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}',
  { attribution: 'Esri' }
);

    esriImagery.addTo(map);
esriLabels.addTo(map);

const baseMaps = {
  "Satellite": esriImagery,
  "Topo": esriTopo
};

const overlays = {
  "Labels": esriLabels
};

L.control.layers(baseMaps, overlays, {
  position: 'topright',
  collapsed: true
}).addTo(map);


//     const esriLabels = L.tileLayer(
//   'https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}',
//   { minZoom: 6 }
// );



// // Labels + roads overlay
// L.tileLayer(
//   'https://server.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}',
//   { attribution: 'Esri' }
// ).addTo(map);

// Load Zion park boundary
fetch('visited_parks.geojson')
  .then(response => response.json())
  .then(data => {
    L.geoJSON(data, {
      style: {
        color: '#ffffff',    // border color
        weight: 2,
        fillColor: '#ffffff', // semi-transparent fill
        fillOpacity: 0.2
      }
    }).addTo(map);
  })
  .catch(err => console.error('Failed to load boundary geojson:', err));

  new L.GPX('ZionTraverse.gpx', {
    async: true,
    polyline_options: {
      color: '#00E5FF',
      weight: 4,
      opacity: 0.9
    },
    
    marker_options: {
      startIconUrl: null,   // no start marker
      endIconUrl: null,     // no end marker
      shadowUrl: null
    
  
    }
  })
new L.GPX('ZionTraverse.gpx', {
  async: true,
  polyline_options: {
    color: '#000000',
    weight: 7,      // slightly thicker
    opacity: 0.8
  },
  marker_options: {
    startIconUrl: null,
    endIconUrl: null,
    shadowUrl: null
  }
}).addTo(map);

    
      
  .on('loaded', function(e) {
    map.fitBounds(e.target.getBounds(), { padding: [20, 20] });
  })
  .on('error', function(err){
    console.error('Failed to load GPX:', err);
  })
  .addTo(map);

const blackTriangle = L.divIcon({
    className: '', // no default styles
    html: '<div style="width: 0; height: 0; border-left: 5px solid transparent; border-right: 5px solid transparent; border-top: 10px solid white;"></div>',
    iconSize: [10, 10],
    iconAnchor: [5, 10] // point the tip at the location
});



    
  // Add photo markers along the route
  const photos = [
    
    { id: 7, lat: 37.451913033497036, lng: -113.19085476210358, caption: "Lee's Pass TH" }, // Lee's Passs 37.451913033497036, -113.19085476210358
    { id: 0, lat: 37.44122339394357, lng: -113.1911679773198, caption: "La Verkin Creek Trail 1" }, // LVCT 1 37.44122339394357, -113.1911679773198
    { id: 1, lat: 37.41736119491232, lng: -113.14624609969904, caption: "Site 11" }, // Site 11 37.41736119491232, -113.14624609969904
    { id: 5, lat: 37.28561389729613, lng: -112.98169245841686, caption: "Site 3" }, // Site 3 - last night 37.28561389729613, -112.98169245841686
    { id: 10, lat: 37.39865875167123, lng: -113.13820534907968, caption: "Hop Valley 1" }, // Hop Valley 1 - 37.39865875167123, -113.13820534907968
    { id: 6, lat: 37.38033818718934, lng: -113.12821879883452, caption: "Hop Valley 2" }, // Hop Valley 2 - 37.38033818718934, -113.12821879883452
    { id: 3, lat: 37.37884768252302, lng: -113.12681601118648, caption: "Hop Valley 3" }, // Hop Valley 3 - 37.37884768252302, -113.12681601118648
    { id: 9, lat: 37.28252457546417, lng: -112.97925092588062, caption: "West Rim 1" } // WR1 - 37.28252457546417, -112.97925092588062
    // ...add more with correct lat/lng and your album index
  ];

  photos.forEach(photo => {
    const marker = L.marker([photo.lat, photo.lng], {
      title: photo.caption,
        icon: blackTriangle
    }).addTo(map);

       marker.bindTooltip(photo.caption, {
    permanent: true,       // always visible
    direction: 'top',      // position above marker
    offset: [10, -10],     // x (right), y (up) in pixels
    className: 'photo-label-text',  // optional CSS class for styling
    interactive: true  
       });

    marker.on('tooltipopen', () => {
  const tooltipEl = marker.getTooltip().getElement();
  if (!tooltipEl) return;

  tooltipEl.addEventListener('click', () => {
    const photoRow = document.querySelectorAll('.photo-row')[photo.id];
    if (photoRow) {
      photoRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }
  });
});


    marker.on('click', () => {
      // Scroll to the photo in your album
      const photoRow = document.querySelectorAll('.photo-row')[photo.id];
      if(photoRow){
        photoRow.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    });
  });
</script>

    
<!-- <script>
  // Initialize map centered on Zion
  const map = L.map('map').setView([37.2982, -113.0263], 13);

  // ESRI World Imagery basemap
  L.tileLayer(
    'https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}',
    { attribution: 'Esri' }
  ).addTo(map);

  // Load and animate GPX trail
  new L.GPX('ZionTraverse.gpx', {
    async: true,
    polyline_options: {
      color: '#00E5FF',
      weight: 4,
      opacity: 0.9
    },
    marker_options: {
      startIcon: null,   // remove start marker
      endIcon: null,     // remove end marker
      shadow: null
    }
  })
  .on('loaded', function(e) {
    // Loop through all layers (tracks) in the GPX file
    e.target.getLayers().forEach(polyline => {
      if (polyline instanceof L.Polyline) {
        const latlngs = polyline.getLatLngs();

        // Zoom map to bounds of this track
        map.fitBounds(polyline.getBounds(), { padding: [20, 20] });

        // Animate drawing
        polyline.setLatLngs([]); // start with empty line
        let i = 0;
        const drawInterval = setInterval(() => {
          if (i < latlngs.length) {
            polyline.addLatLng(latlngs[i]);
            i++;
          } else {
            clearInterval(drawInterval);
          }
        }, 25); // adjust speed here (ms per point)
      }
    });
  })
  .on('error', function(err){
    console.error('Failed to load GPX:', err);
  })
  .addTo(map);
</script> -->


    
<script>
  const container = document.getElementById('album-container');

  // Load photo data from JSON
  fetch('photos.json')
    .then(response => response.json())
    .then(photos => {
      photos.forEach(photo => {
        const row = document.createElement('div');
        row.className = 'photo-row';

        // Link to high-res
        const link = document.createElement('a');
        link.href = photo.highres;
        link.target = "_blank";

        // Image
        const img = document.createElement('img');
        img.src = photo.src;
        img.alt = photo.caption;
        img.loading = "eager";  // ensures image loads right away

        link.appendChild(img);

        // Caption
        const p = document.createElement('p');
        p.innerHTML = photo.caption.replace(/\n/g, '<br>');

        // Append to row
        row.appendChild(link);
        row.appendChild(p);
        container.appendChild(row);
      });

      // Fade-in on scroll
      const observer = new IntersectionObserver(entries => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add('visible');
            observer.unobserve(entry.target);
          }
        });
      }, { threshold: 0.2 });

      document.querySelectorAll('.photo-row').forEach(row => observer.observe(row));
    })
    .catch(err => console.error('Failed to load photos.json:', err));
</script>

</body>
</html>
